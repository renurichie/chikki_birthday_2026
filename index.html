<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Birthday Memories üíñ</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    font-family: 'Arial', sans-serif;
    overflow-x:hidden;
}

/* Initial Question Page */
.question-page{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100vh;
    background: linear-gradient(135deg, #ffd1e8, #fff);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:10000;
    transition:opacity 0.5s, transform 0.5s;
}

.question-page.hidden{
    opacity:0;
    transform:scale(0.9);
    pointer-events:none;
}

.question-card{
    background:white;
    padding:50px;
    border-radius:30px;
    text-align:center;
    max-width:600px;
    box-shadow:0 20px 40px rgba(0,0,0,.15);
    animation:cardEntry 0.8s ease-out;
}

@keyframes cardEntry{
    from{transform:scale(0.8); opacity:0;}
    to{transform:scale(1); opacity:1;}
}

.question-card h2{
    font-size:2em;
    color:#333;
    margin:20px 0;
}

.question-card button{
    padding:15px 40px;
    border-radius:50px;
    border:none;
    font-size:18px;
    cursor:pointer;
    margin:10px;
    transition:transform 0.2s;
    font-weight:bold;
}

.question-card .button-container{
    display:flex;
    gap:15px;
    justify-content:center;
    margin-top:25px;
    flex-wrap:wrap;
}

.question-card button:hover{
    transform:translateY(-2px) scale(1.05);
}

#yes{
    background:#ff4d88;
    color:white;
    transition: transform 0.3s ease-out;
    position: relative;
}

#no{
    background:#eee;
}

#shyText{
    opacity:0;
    transition:opacity 0.3s;
    height:20px;
    margin-top:10px;
    color:#ff4d88;
}

/* Countdown Page */
.countdown-page{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100vh;
    background: linear-gradient(135deg, #ff9ecd, #ffd1e8);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9999;
    opacity:0;
    pointer-events:none;
    transition:opacity 0.5s;
}

.countdown-page.active{
    opacity:1;
    pointer-events:all;
}

.countdown-card{
    background:white;
    padding:60px;
    border-radius:30px;
    text-align:center;
    box-shadow:0 25px 50px rgba(0,0,0,.2);
}

#countdown{
    font-size:100px;
    color:#ff4d88;
    font-weight:bold;
    animation:pulse 1s infinite;
}

@keyframes pulse{
    0%, 100%{transform:scale(1);}
    50%{transform:scale(1.2);}
}

/* Photo Collage Main Page */
.collage-page{
    min-height:100vh;
    background: linear-gradient(135deg, #ffd1e8, #fff5f9, #ffe6f0);
    padding:40px 20px;
    opacity:0;
    pointer-events:none;
    transition:opacity 0.8s ease-in-out;
}

.collage-page.active{
    opacity:1;
    pointer-events:all;
}

.collage-header{
    text-align:center;
    margin-bottom:40px;
    animation:fadeInDown 1s;
}

.collage-header h1{
    font-size:3em;
    color:#ff4d88;
    margin-bottom:10px;
    text-shadow:2px 2px 4px rgba(0,0,0,.1);
}

.collage-header p{
    font-size:1.3em;
    color:#666;
}

/* Photo Grid/Collage */
.photo-grid{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:20px;
    max-width:1400px;
    margin:0 auto;
    padding:20px;
}

.photo-item{
    position:relative;
    overflow:hidden;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,.15);
    cursor:pointer;
    transition:all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    animation:fadeInUp 0.8s ease-out;
    animation-fill-mode:both;
    width:calc(33.333% - 14px);
    min-width:280px;
    max-width:450px;
}

.photo-item:nth-child(1){animation-delay:0.1s;}
.photo-item:nth-child(2){animation-delay:0.2s;}
.photo-item:nth-child(3){animation-delay:0.3s;}
.photo-item:nth-child(4){animation-delay:0.4s;}
.photo-item:nth-child(5){animation-delay:0.5s;}

@keyframes fadeInUp{
    from{
        opacity:0;
        transform:translateY(30px);
    }
    to{
        opacity:1;
        transform:translateY(0);
    }
}

@keyframes fadeInDown{
    from{
        opacity:0;
        transform:translateY(-30px);
    }
    to{
        opacity:1;
        transform:translateY(0);
    }
}

.photo-item:hover{
    transform:translateY(-10px) scale(1.02);
    box-shadow:0 20px 40px rgba(255,77,136,.3);
}

.photo-item img{
    width:100%;
    height:350px;
    object-fit:cover;
    display:block;
    transition:transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.photo-item:hover img{
    transform:scale(1.1);
}

.photo-overlay{
    position:absolute;
    bottom:0;
    left:0;
    right:0;
    background:linear-gradient(transparent, rgba(0,0,0,0.7));
    padding:20px;
    transform:translateY(0);
}

.photo-overlay h3{
    color:white;
    font-size:1.4em;
    margin-bottom:5px;
}

.photo-overlay p{
    color:#ffd1e8;
    font-size:0.95em;
}

/* Individual Memory Page */
.memory-page{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100vh;
    background: linear-gradient(135deg, #ff9ecd, #ffd1e8, #ffe6f0);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9000;
    opacity:0;
    pointer-events:none;
    transition:opacity 0.6s ease-in-out;
    padding:20px;
}

.memory-page.active{
    opacity:1;
    pointer-events:all;
}

.memory-page.active .memory-card{
    animation:slideUpReveal 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.memory-card{
    background:white;
    padding:40px;
    border-radius:30px;
    max-width:800px;
    width:calc(100% - 40px);
    max-height:90vh;
    overflow-y:auto;
    box-shadow:0 25px 60px rgba(255,77,136,.25);
    position:relative;
    transform:scale(0.85) translateY(40px);
    opacity:0;
    scrollbar-width:thin;
    scrollbar-color:rgba(255,77,136,0.3) transparent;
}

.memory-card::-webkit-scrollbar{
    width:6px;
}

.memory-card::-webkit-scrollbar-track{
    background:transparent;
}

.memory-card::-webkit-scrollbar-thumb{
    background:rgba(255,77,136,0.3);
    border-radius:10px;
}

.memory-card::-webkit-scrollbar-thumb:hover{
    background:rgba(255,77,136,0.5);
}

@keyframes slideUpReveal{
    0%{
        transform:scale(0.85) translateY(40px);
        opacity:0;
    }
    60%{
        opacity:1;
    }
    100%{
        transform:scale(1) translateY(0);
        opacity:1;
    }
}

.memory-page.active .memory-card h1{
    animation:titleReveal 0.8s ease-out 0.3s both;
}

@keyframes titleReveal{
    from{
        opacity:0;
        transform:translateY(-20px);
        filter:blur(4px);
    }
    to{
        opacity:1;
        transform:translateY(0);
        filter:blur(0);
    }
}

.memory-page.active .memory-card img{
    animation:imgReveal 0.9s ease-out 0.5s both;
}

@keyframes imgReveal{
    from{
        opacity:0;
        transform:scale(0.9);
        filter:blur(6px);
    }
    to{
        opacity:1;
        transform:scale(1);
        filter:blur(0);
    }
}

.memory-page.active .memory-card .message{
    animation:textFadeIn 0.8s ease-out 0.7s both;
}

.memory-page.active .memory-card .quote{
    animation:textFadeIn 0.8s ease-out 0.9s both;
}

.memory-page.active .memory-card .music-indicator{
    animation:textFadeIn 0.8s ease-out 1s both;
}

.memory-page.active .memory-card .memory-nav{
    animation:textFadeIn 0.8s ease-out 1.1s both;
}

@keyframes textFadeIn{
    from{
        opacity:0;
        transform:translateY(15px);
    }
    to{
        opacity:1;
        transform:translateY(0);
    }
}

.close-btn{
    position:absolute;
    top:20px;
    right:20px;
    background:#ff4d88;
    color:white;
    border:none;
    width:40px;
    height:40px;
    border-radius:50%;
    font-size:24px;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all 0.3s;
    z-index:10;
}

.close-btn:hover{
    background:#ff1a66;
    transform:rotate(90deg);
}

.memory-card h1{
    font-size:2.5em;
    color:#ff4d88;
    margin-bottom:20px;
    text-align:center;
}

.memory-card img{
    width:100%;
    max-height:450px;
    object-fit:cover;
    border-radius:20px;
    margin:20px 0;
    box-shadow:0 10px 30px rgba(0,0,0,.15);
}

.memory-card .message{
    font-size:1.2em;
    line-height:1.8;
    color:#555;
    margin:20px 0;
    text-align:center;
}

.memory-card .quote{
    font-style:italic;
    color:#ff4d88;
    font-size:1.1em;
    text-align:center;
    padding:20px;
    background:#fff5f9;
    border-radius:15px;
    margin-top:20px;
}

.music-indicator{
    text-align:center;
    margin-top:20px;
    padding:15px;
    background:linear-gradient(135deg, #ffd1e8, #ffb3d9);
    border-radius:15px;
    color:white;
    font-size:1.1em;
    animation:musicPulse 2s ease-in-out infinite;
}

@keyframes musicPulse{
    0%, 100%{opacity:0.8;}
    50%{opacity:1;}
}

/* Navigation between memories */
.memory-nav{
    display:flex;
    justify-content:center;
    gap:15px;
    margin-top:25px;
    flex-wrap:wrap;
}

.memory-nav button{
    padding:12px 30px;
    border-radius:25px;
    border:2px solid #ff4d88;
    background:white;
    color:#ff4d88;
    font-size:16px;
    cursor:pointer;
    transition:all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    font-weight:bold;
}

.memory-nav button:hover{
    background:#ff4d88;
    color:white;
    transform:translateY(-3px);
    box-shadow:0 6px 20px rgba(255,77,136,.35);
}

.memory-nav button:disabled{
    opacity:0.3;
    cursor:not-allowed;
    transform:none;
}

/* Effects */
.confetti{
    position:fixed;
    width:10px;
    height:10px;
    background:#ff4d88;
    pointer-events:none;
    animation:confetti-fall 3s linear forwards;
    z-index:10000;
}

@keyframes confetti-fall{
    to{
        transform:translateY(100vh) rotate(360deg);
        opacity:0;
    }
}

.heart-float{
    position:fixed;
    font-size:30px;
    pointer-events:none;
    animation:float-up 3s ease-out forwards;
    z-index:10000;
}

@keyframes float-up{
    to{
        transform:translateY(-100vh) scale(1.5);
        opacity:0;
    }
}

.sparkle{
    position:fixed;
    width:5px;
    height:5px;
    background:gold;
    border-radius:50%;
    pointer-events:none;
    box-shadow:0 0 10px gold;
    animation:sparkle-fade 1.5s ease-out forwards;
    z-index:10000;
}

@keyframes sparkle-fade{
    0%{transform:scale(0); opacity:1;}
    50%{transform:scale(1.5); opacity:1;}
    100%{transform:scale(0); opacity:0;}
}

@keyframes burstOut{
    0%{
        transform:translate(0, 0) scale(1);
        opacity:1;
    }
    100%{
        transform:translate(var(--tx, 100px), var(--ty, 100px)) scale(0.5);
        opacity:0;
    }
}

.popper-particle{
    position:fixed;
    pointer-events:none;
    z-index:99999;
    font-size:20px;
    animation:popperBurst 0.9s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}

@keyframes popperBurst{
    0%{
        transform:translate(0,0) scale(0.5) rotate(0deg);
        opacity:1;
    }
    30%{
        transform:translate(calc(var(--px) * 0.4), calc(var(--py) * 0.4)) scale(1.2) rotate(calc(var(--pr, 360deg) * 0.3));
        opacity:1;
    }
    100%{
        transform:translate(var(--px), var(--py)) scale(0.2) rotate(var(--pr, 360deg));
        opacity:0;
    }
}

/* Responsive Design */
@media (max-width: 768px){
    .collage-header h1{font-size:2.2em;}
    .collage-header p{font-size:1.1em;}
    
    .photo-grid{
        gap:15px;
    }
    .photo-item{
        width:100%;
        max-width:100%;
    }
    
    .photo-item img{height:280px;}
    
    .memory-card{
        padding:25px 15px;
        border-radius:20px;
    }

    .memory-card h1{font-size:1.6em; word-wrap:break-word;}
    .memory-card img{max-height:300px;}
    .memory-card .message{font-size:1em;}
    .memory-card .quote{font-size:0.95em; padding:15px;}
    .music-indicator{font-size:0.95em; padding:12px;}
    
    .question-card{padding:30px 20px;}
    .question-card h2{font-size:1.6em;}
    
    #countdown{font-size:70px;}
    
    .memory-nav button{
        padding:10px 20px;
        font-size:14px;
    }
}

@media (max-width: 480px){
    .collage-header h1{font-size:1.8em;}
    .photo-item img{height:220px;}
    .memory-card{padding:20px 12px; border-radius:18px;}
    .memory-card h1{font-size:1.35em;}
    .memory-card img{max-height:220px;}
    .memory-card .message{font-size:0.95em; line-height:1.6;}
    .memory-card .quote{font-size:0.9em; padding:12px;}
    .memory-nav button{padding:8px 16px; font-size:13px;}
}
</style>
</head>

<body>

<!-- Question Page -->
<div class="question-page" id="questionPage">
    <div class="question-card">
        üéÇ‚ú®
        <h2 id="questionText">Your special day just got extra special... want to see why?</h2>
        <p id="hintText" style="font-size:0.9em; color:#888; margin:10px 0; opacity:0; transition:opacity 0.3s;">Try to catch the button if you can! üòè</p>
        <p id="attemptCounter" style="font-size:0.85em; color:#ff4d88; margin:10px 0; opacity:0; transition:opacity 0.3s; font-weight:bold;"></p>
        <div class="button-container" id="buttonContainer">
            <button id="yes" onmouseover="tryToCatch()" onclick="handleCatch()">Bring it on!</button>
            <button id="no" onclick="showHint()" style="background:#eee; padding:15px 40px; border-radius:50px; border:none; font-size:18px; cursor:pointer; font-weight:bold; transition:all 0.3s;">Maybe later?</button>
        </div>
        <p id="shyText"></p>
    </div>
</div>

<!-- Countdown Page -->
<div class="countdown-page" id="countdownPage">
    <div class="countdown-card">
        <h1 style="font-size:60px;">üéâ</h1>
        <h2>Get ready...</h2>
        <h1 id="countdown">3</h1>
    </div>
</div>

<!-- Photo Collage Main Page -->
<div class="collage-page" id="collagePage">
    <div class="collage-header">
        <h1>üéÇ Happy Birthday My Love! üéÇ</h1>
        <p>Every picture on this wall tells a story ‚Äî a core memory of us together üíï</p>
        <p style="font-size:0.95em; color:#e91e84; margin-top:8px; font-style:italic;">This is our memory wall, and it's only the beginning ‚Äî we'll keep adding more pictures and stories as we make new memories together üå∏</p>
    </div>

    <div class="photo-grid" id="photoGrid">
        <!-- Photos will be generated here -->
    </div>
</div>

<!-- Individual Memory Pages -->
<div id="memoryPages">
    <!-- Memory pages will be generated here -->
</div>

<!-- Background song for collage page -->
<audio id="bgMusic" loop>
    <source src="yemaindonamadi.mp3" type="audio/mp3">
</audio>

<!-- Audio elements for each memory -->
<div id="audioElements"></div>

<script>
// Memory Data - CUSTOMIZE EVERYTHING HERE!
const memories = [
    {
        id: 1,
        thumbnail: 'first.png',
        image: 'first.png',
        title: 'üåü The Day We Met',
        preview: 'Where it all began...',
        message: 'When i saw you for the 1st time, I never knew you would become my best friend. You walked into my world and brought colors I never knew existed. This is where our beautiful story started, and I thank the universe every day for bringing you to me.',
        quote: '"In a sea of people, my eyes will always search for you" üí´',
        song: 'Gaaju Bomma.mp3'
    },
    {
        id: 2,
        thumbnail: 'first_together.png',
        image: 'first_together.png',
        title: 'üíï Our First Picture',
        preview: 'Starting of a new phase...',
        message: 'I still remember the 1st time we took this picture together you slipped into my arms like a baby like we knew each other from ages. It was the beginning of a beautiful journey filled with love, laughter, and endless adventures. Every moment since then has been a blessing.',
        quote: '"Life is either a daring adventure or nothing at all" - And I choose adventure with you! üåç',
        song: 'perfect.mp3'
    },
    {
        id: 3,
        thumbnail: 'holdinghands.jpeg',
        image: 'holdinghands.jpeg',
        title: '‚ú® Holding Hands Till Forever',
        preview: 'The light of my life...',
        message: 'Your smile has the power to brighten my darkest days. When you laugh, the whole world lights up. Your happiness is my happiness, and seeing you smile is all I need to feel complete. Never stop smiling, my love.',
        quote: '"Your smile is the key to my heart" üòäüíñ',
        song: 'sadanannu.mp3'
    },
    {
        id: 4,
        thumbnail: 'pondy.jpeg',
        image: 'pondy.jpeg',
        title: 'üéà Our 1st Trip Together',
        preview: 'Making memories...',
        message: 'Every adventure with you feels like a dream come true. Whether we\'re exploring new places or just walking hand in hand, you make every moment magical. With you, even the ordinary becomes extraordinary.',
        quote: '"The best things in life are the people we love, the places we\'ve been, and the memories we\'ve made" üéâ',
        song: 'Tere_Bina.mp3'
    },
    {
        id: 5,
        thumbnail: 'Fav togeather.PNG',
        image: 'Fav togeather.PNG',
        title: '‚ù§Ô∏è Forever and Always',
        preview: 'Our future together...',
        message: 'As we celebrate your birthday today, I want you to know that you are my yesterday, my today, and all of my tomorrows. My love for you grows stronger with each passing day. Here\'s to forever together, creating more beautiful memories, and loving each other through it all.',
        quote: '"I love you not only for what you are, but for what I am when I am with you" üíù',
        song: 'Kalalo Kooda.mp3'
    },
    {
        id: 6,
        thumbnail: 'Tirumala.jpg',
        image: 'Tirumala.jpg',
        title: 'üôè Our Tirumala Journey',
        preview: 'Where faith met love...',
        message: 'Our journey to Tirumala together is a core memory I\'ll cherish forever. Standing before my swamy with you, seeking His blessings together, felt like a dream. That day, our faith and love came together. Govinda Govinda! Thank you for everything you have done to me.',
        quote: '"Together we sought His blessings, and together we found forever üôè‚ú®"',
        song: 'tirumala.mp3'
    },
    {
        id: 7,
        thumbnail: 'fav.jpeg',
        image: 'fav.jpeg',
        title: 'üì∏ Our 1st Picture at Our Home',
        preview: 'You made me love pictures...',
        message: 'I was never a fan of taking pictures, but everything changed when you entered my life. For the first time, I felt pretty taking pics with someone. Look at my face in this picture ‚Äî look how happy I am when I am with you! It\'s your smile that melts me every single time. You brought out a side of me I never knew existed, and now every picture with you is my favorite picture.',
        quote: '"You made me fall in love with moments I never wanted to capture before" üì∏üíñ',
        song: 'mila mila.mp3'
    },
    {
        id: 8,
        thumbnail: 'aasateerinaka.jpeg',
        image: 'aasateerinaka.jpeg',
        title: 'Our Little Book of Us üìñ',
        preview: 'Where we started writing our story',
        message: 'That day at the bookstore was pure magic. We walked in just to browse, but we walked out with something so much more ‚Äî a little book to write down our memorable days, the days that truly matter to us. It was your idea, and I fell in love with it instantly. A place where we could hold onto every beautiful moment we share together, written in our own words. That bookstore gave us more than just a book ‚Äî it gave us a tradition, a promise to never let our special days fade away.',
        quote: '"Some love stories are lived, some are written ‚Äî ours is both" üìñüíï',
        song: 'Yedemaina-Sakhi.mp3'
    },
    {
        id: 9,
        thumbnail: 'neeli megamulalo.jpeg',
        image: 'neeli megamulalo.jpeg',
        title: 'My Wifey Before the World Knew üíç',
        preview: 'She chose me forever...',
        message: 'This is the moment you became my wifey ‚Äî no mandap, no rituals, no official papers, just your hand on my face and all the love in the world. You didn\'t need a ceremony to claim me as yours. The way you look at me in this picture, the way you hold me ‚Äî that\'s a promise stronger than any vow. You became my wife the day your heart chose mine, and everything else is just a formality the world needs. I already belong to you, completely.',
        quote: '"We didn\'t need the world\'s permission to belong to each other" üíçüíñ',
        song: 'Neeli Meghamula lo.mp3'
    }
    
];

let currentMemoryIndex = -1;
let currentAudio = null;
let celebrationStarted = false;
let interactionStage = 0;
let catchAttempts = 0;
let maxAttempts = 6; // Number of times button runs away before allowing click

// Initialize
function init(){
    generatePhotoGrid();
    generateMemoryPages();
    generateAudioElements();
}

function showHint(){
    const hintText = document.getElementById('hintText');
    const shyText = document.getElementById('shyText');
    
    if(interactionStage === 0){
        hintText.style.opacity = '1';
        shyText.textContent = "Come on, you know you want to! üòà";
        shyText.style.opacity = '1';
        shyText.style.color = '#ff4d88';
        
        setTimeout(() => {
            shyText.style.opacity = '0';
        }, 2000);
    }
}

function tryToCatch(){
    const yesBtn = document.getElementById('yes');
    const attemptCounter = document.getElementById('attemptCounter');
    const hintText = document.getElementById('hintText');
    
    if(interactionStage === 0 && catchAttempts < maxAttempts){
        // Button runs away!
        catchAttempts++;
        
        const maxX = 250;
        const maxY = 200;
        const newX = Math.random() * maxX - maxX/2;
        const newY = Math.random() * maxY - maxY/2;
        
        yesBtn.style.transform = `translate(${newX}px, ${newY}px)`;
        
        // Show attempt counter
        attemptCounter.style.opacity = '1';
        attemptCounter.textContent = `Keep trying! üí™`;
        
        // Show hint after 3 attempts
        if(catchAttempts === 3){
            hintText.textContent = "Almost there! Don't give up! üòè";
            hintText.style.opacity = '1';
        }
        
        // Encouraging messages
        const encouragements = [
            "Oops! Try again! üòú",
            "So close! üòè",
            "Not quite! Keep going! üíï",
            "Almost got it! üéØ",
            "One more time! You can do it! üí™",
            "Last chance... or is it? üòà"
        ];
        
        const shyText = document.getElementById('shyText');
        shyText.textContent = encouragements[catchAttempts - 1] || encouragements[0];
        shyText.style.opacity = '1';
        shyText.style.color = '#ff4d88';
    }
}

function handleCatch(){
    if(interactionStage === 0 && catchAttempts >= maxAttempts){
        // They finally caught it!
        interactionStage = 1;
        
        const questionText = document.getElementById('questionText');
        const buttonContainer = document.getElementById('buttonContainer');
        const shyText = document.getElementById('shyText');
        const attemptCounter = document.getElementById('attemptCounter');
        const hintText = document.getElementById('hintText');
        
        // Mini celebration for catching the button!
        createMiniCelebration();
        
        // Hide attempt counter and hint
        attemptCounter.style.opacity = '0';
        hintText.style.opacity = '0';
        
        // Celebrate the catch!
        questionText.innerHTML = 'Ahh seems like you are more excited! üéâ<br><span style="font-size:0.8em; color:#666;">I knew you couldn\'t resist...</span>';
        shyText.textContent = "Now, are you REALLY ready for the surprise? üòè";
        shyText.style.opacity = '1';
        
        // Show the final button with animation
        buttonContainer.innerHTML = `
            <button onclick="startSurprise()" 
                style="background: linear-gradient(135deg, #ff4d88, #ff69b4); 
                       color:white; 
                       padding:18px 45px; 
                       border-radius:50px; 
                       border:none; 
                       font-size:20px; 
                       cursor:pointer; 
                       font-weight:bold; 
                       animation:pulse 1.5s infinite;
                       box-shadow: 0 5px 15px rgba(255,77,136,0.4);
                       transition: all 0.3s;"
                onmouseover="this.style.transform='scale(1.1)'"
                onmouseout="this.style.transform='scale(1)'">
                YES! SHOW ME! üéÅ
            </button>
        `;
    } else if(interactionStage === 0 && catchAttempts < maxAttempts){
        // Still running away, don't allow click
        tryToCatch();
    }
}

function createMiniCelebration(){
    // Create a burst of hearts and sparkles when they catch the button
    const colors = ['üíñ', 'üíï', '‚ú®', 'üéâ', '‚≠ê'];
    
    for(let i = 0; i < 15; i++){
        setTimeout(() => {
            const particle = document.createElement('div');
            particle.textContent = colors[Math.floor(Math.random() * colors.length)];
            particle.style.position = 'fixed';
            particle.style.left = '50%';
            particle.style.top = '50%';
            particle.style.fontSize = '25px';
            particle.style.pointerEvents = 'none';
            particle.style.zIndex = '10000';
            
            const angle = (Math.PI * 2 * i) / 15;
            const velocity = 100 + Math.random() * 100;
            const tx = Math.cos(angle) * velocity;
            const ty = Math.sin(angle) * velocity;
            
            particle.style.animation = `burstOut 1s ease-out forwards`;
            particle.style.transform = `translate(${tx}px, ${ty}px)`;
            particle.style.opacity = '0';
            
            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 1000);
        }, i * 30);
    }
}

function moveNo(){
    // This function is no longer needed but kept for compatibility
}

function hideShy(){
    // This function is no longer needed but kept for compatibility
}

function startSurprise(){
    document.getElementById('questionPage').classList.add('hidden');
    document.getElementById('countdownPage').classList.add('active');
    
    let count = 3;
    const countInterval = setInterval(() => {
        count--;
        const countdownEl = document.getElementById("countdown");
        if(count > 0){
            countdownEl.textContent = count;
        } else {
            clearInterval(countInterval);
            setTimeout(() => {
                document.getElementById('countdownPage').classList.remove('active');
                document.getElementById('collagePage').classList.add('active');
                startCelebration();
                playBgMusic();
            }, 500);
        }
    }, 1000);
}

function generatePhotoGrid(){
    const grid = document.getElementById('photoGrid');
    
    memories.forEach((memory, index) => {
        const item = document.createElement('div');
        item.className = 'photo-item';
        item.onclick = () => openMemory(index);
        
        item.innerHTML = `
            <img src="${memory.thumbnail}" alt="${memory.title}">
            <div class="photo-overlay">
                <h3>${memory.title}</h3>
                <p>${memory.preview}</p>
            </div>
        `;
        
        grid.appendChild(item);
    });
}

function generateMemoryPages(){
    const container = document.getElementById('memoryPages');
    
    memories.forEach((memory, index) => {
        const page = document.createElement('div');
        page.className = 'memory-page';
        page.id = `memory${index}`;
        
        const prevDisabled = index === 0 ? 'disabled' : '';
        const nextDisabled = index === memories.length - 1 ? 'disabled' : '';
        
        page.innerHTML = `
            <div class="memory-card">
                <button class="close-btn" onclick="closeMemory()">√ó</button>
                <h1>${memory.title}</h1>
                <img src="${memory.image}" alt="${memory.title}">
                <div class="message">${memory.message}</div>
                <div class="quote">${memory.quote}</div>
                <div class="music-indicator">
                    üéµ Now Playing: ${memory.song} üéµ
                </div>
                <div class="memory-nav">
                    <button onclick="navigateMemory(${index - 1})" ${prevDisabled}>‚Üê Previous</button>
                    <button onclick="closeMemory()">Back to Collage</button>
                    <button onclick="navigateMemory(${index + 1})" ${nextDisabled}>Next ‚Üí</button>
                </div>
            </div>
        `;
        
        container.appendChild(page);
    });
}

function generateAudioElements(){
    const container = document.getElementById('audioElements');
    
    memories.forEach((memory, index) => {
        const audio = document.createElement('audio');
        audio.id = `audio${index}`;
        audio.loop = true;
        audio.innerHTML = `<source src="${memory.song}" type="audio/mpeg">`;
        container.appendChild(audio);
    });
}

function playBgMusic(){
    const bg = document.getElementById('bgMusic');
    if(bg){
        bg.play().catch(err => console.log('BG music play failed:', err));
    }
}

function pauseBgMusic(){
    const bg = document.getElementById('bgMusic');
    if(bg){
        bg.pause();
    }
}

function createCrackersBurst(){
    const crackers = ['üéâ', 'üéä', 'üß®', '‚ú®', 'üí•', 'üéá', 'üéÜ', 'üíñ'];
    const centerX = window.innerWidth / 2;
    const centerY = window.innerHeight / 2;

    // Big center burst
    for(let i = 0; i < 25; i++){
        setTimeout(() => {
            const p = document.createElement('div');
            p.className = 'popper-particle';
            p.textContent = crackers[Math.floor(Math.random() * crackers.length)];
            p.style.left = centerX + 'px';
            p.style.top = centerY + 'px';
            p.style.fontSize = (18 + Math.random() * 16) + 'px';

            const angle = (Math.PI * 2 * i) / 25;
            const dist = 100 + Math.random() * 150;
            p.style.setProperty('--px', Math.cos(angle) * dist + 'px');
            p.style.setProperty('--py', Math.sin(angle) * dist + 'px');
            p.style.setProperty('--pr', (Math.random() * 720 - 360) + 'deg');

            document.body.appendChild(p);
            setTimeout(() => p.remove(), 900);
        }, i * 20);
    }

    // Corner bursts
    const corners = [[0, 0], [window.innerWidth, 0], [0, window.innerHeight], [window.innerWidth, window.innerHeight]];
    corners.forEach((corner, ci) => {
        for(let i = 0; i < 8; i++){
            setTimeout(() => {
                const p = document.createElement('div');
                p.className = 'popper-particle';
                p.textContent = crackers[Math.floor(Math.random() * crackers.length)];
                p.style.left = corner[0] + 'px';
                p.style.top = corner[1] + 'px';
                p.style.fontSize = '22px';

                const angle = (Math.PI * 2 * i) / 8;
                const dist = 80 + Math.random() * 100;
                p.style.setProperty('--px', Math.cos(angle) * dist + 'px');
                p.style.setProperty('--py', Math.sin(angle) * dist + 'px');
                p.style.setProperty('--pr', (Math.random() * 360) + 'deg');

                document.body.appendChild(p);
                setTimeout(() => p.remove(), 900);
            }, ci * 100 + i * 25);
        }
    });
}

function openMemory(index){
    currentMemoryIndex = index;

    // Pause background music
    pauseBgMusic();

    // Fire crackers burst
    createCrackersBurst();

    // Smooth fade out collage
    document.getElementById('collagePage').style.transition = 'opacity 0.5s ease-in-out';
    document.getElementById('collagePage').style.opacity = '0';

    setTimeout(() => {
        // Show memory page with smooth reveal
        const memPage = document.getElementById(`memory${index}`);
        memPage.classList.add('active');

        // Play corresponding song
        playMemorySong(index);
    }, 400);
}

function closeMemory(){
    if(currentMemoryIndex !== -1){
        const memPage = document.getElementById(`memory${currentMemoryIndex}`);
        // Smooth exit: scale down and fade
        memPage.style.transition = 'opacity 0.4s ease-in-out';
        memPage.style.opacity = '0';

        setTimeout(() => {
            memPage.classList.remove('active');
            memPage.style.opacity = '';
            memPage.style.transition = '';
        }, 400);
    }

    // Stop current song
    stopAllSongs();

    setTimeout(() => {
        document.getElementById('collagePage').style.transition = 'opacity 0.5s ease-in-out';
        document.getElementById('collagePage').style.opacity = '1';
        // Resume background music after transition
        playBgMusic();
    }, 350);

    currentMemoryIndex = -1;
}

function navigateMemory(newIndex){
    if(newIndex < 0 || newIndex >= memories.length) return;

    const oldPage = document.getElementById(`memory${currentMemoryIndex}`);

    // Smooth fade out old page
    oldPage.style.transition = 'opacity 0.35s ease-in-out';
    oldPage.style.opacity = '0';

    setTimeout(() => {
        oldPage.classList.remove('active');
        oldPage.style.opacity = '';
        oldPage.style.transition = '';

        // Fire crackers for the new slide
        createCrackersBurst();

        // Show new page
        currentMemoryIndex = newIndex;
        const newPage = document.getElementById(`memory${newIndex}`);
        newPage.classList.add('active');
        playMemorySong(newIndex);
    }, 350);
}

function playMemorySong(index){
    // Stop all songs first
    stopAllSongs();
    
    // Play new song
    currentAudio = document.getElementById(`audio${index}`);
    if(currentAudio){
        currentAudio.play().catch(err => {
            console.log('Audio play failed:', err);
        });
    }
}

function stopAllSongs(){
    memories.forEach((_, index) => {
        const audio = document.getElementById(`audio${index}`);
        if(audio){
            audio.pause();
            audio.currentTime = 0;
        }
    });
}

function startCelebration(){
    if(celebrationStarted) return;
    celebrationStarted = true;
    
    createConfetti();
    createFloatingHearts();
    createSparkles();
    createBalloons();
    
    setInterval(createConfetti, 3000);
}

function createConfetti(){
    const hearts = ['üíñ', 'üíó', 'üíï', 'üíù', '‚ù§Ô∏è', 'üíì'];
    for(let i = 0; i < 80; i++){
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.textContent = hearts[Math.floor(Math.random() * hearts.length)];
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.top = '-10px';
            confetti.style.background = 'none';
            confetti.style.fontSize = '20px';
            confetti.style.width = 'auto';
            confetti.style.height = 'auto';
            confetti.style.animationDelay = Math.random() * 0.5 + 's';
            confetti.style.animationDuration = (2 + Math.random() * 2) + 's';
            document.body.appendChild(confetti);
            setTimeout(() => confetti.remove(), 5000);
        }, i * 30);
    }
}

function createFloatingHearts(){
    const hearts = ['üíñ', 'üíó', 'üíï', 'üíù', '‚ù§Ô∏è', 'üíì'];
    for(let i = 0; i < 15; i++){
        setTimeout(() => {
            const heart = document.createElement('div');
            heart.className = 'heart-float';
            heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
            heart.style.left = Math.random() * 100 + '%';
            heart.style.bottom = '0px';
            heart.style.animationDelay = Math.random() * 0.5 + 's';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 3500);
        }, i * 150);
    }
}

function createSparkles(){
    for(let i = 0; i < 40; i++){
        setTimeout(() => {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.top = Math.random() * 100 + '%';
            document.body.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 2000);
        }, i * 50);
    }
}

function createBalloons(){
    const balloons = ['üéà', 'üéâ', 'üéä', 'üéÅ', 'üéÄ'];
    for(let i = 0; i < 12; i++){
        setTimeout(() => {
            const balloon = document.createElement('div');
            balloon.className = 'heart-float';
            balloon.textContent = balloons[Math.floor(Math.random() * balloons.length)];
            balloon.style.left = Math.random() * 100 + '%';
            balloon.style.bottom = '0px';
            balloon.style.fontSize = '35px';
            balloon.style.animationDelay = Math.random() * 0.3 + 's';
            document.body.appendChild(balloon);
            setTimeout(() => balloon.remove(), 3500);
        }, i * 200);
    }
}

// Click blast/popper effect
document.addEventListener('mousedown', function(e){
    const poppers = ['üéâ', 'üéä', '‚ú®', 'üíñ', '‚≠ê', 'üéÄ', 'üí´', 'üåü'];
    const particleCount = 12;

    for(let i = 0; i < particleCount; i++){
        const particle = document.createElement('div');
        particle.className = 'popper-particle';
        particle.textContent = poppers[Math.floor(Math.random() * poppers.length)];
        particle.style.left = e.clientX + 'px';
        particle.style.top = e.clientY + 'px';

        const angle = (Math.PI * 2 * i) / particleCount;
        const distance = 60 + Math.random() * 80;
        const px = Math.cos(angle) * distance;
        const py = Math.sin(angle) * distance;
        const rotation = Math.random() * 720 - 360;

        particle.style.setProperty('--px', px + 'px');
        particle.style.setProperty('--py', py + 'px');
        particle.style.setProperty('--pr', rotation + 'deg');

        document.body.appendChild(particle);
        setTimeout(() => particle.remove(), 800);
    }
}, true);

// Initialize on load
init();
</script>

</body>
</html>